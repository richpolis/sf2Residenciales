{% extends 'BackendBundle::layout.html.twig' %}

{% block stylesheets %}
    <!-- Stylesheets -->
    <link rel="stylesheet" href="{{asset('css/bootstrap.css')}}">
    <!-- Font awesome icon -->
    <link rel="stylesheet" href="{{asset('css/font-awesome.css')}}"> 
    <!-- jQuery UI -->
    <link rel="stylesheet" href="{{asset('css/jquery-ui-1.9.2.custom.min.css')}}"> 
    <!-- Calendar -->
    <link rel="stylesheet" href="{{asset('css/fullcalendar.css')}}">
    <!-- prettyPhoto -->
    <link rel="stylesheet" href="{{asset('css/prettyPhoto.css')}}">  
    <!-- Star rating -->
    <link rel="stylesheet" href="{{asset('css/rateit.css')}}">
    <!-- Date picker -->
    <link rel="stylesheet" href="{{asset('css/bootstrap-datetimepicker.min.css')}}">
    <!-- CLEditor -->
    <link rel="stylesheet" href="{{asset('css/jquery.cleditor.css')}}"> 
    <!-- Uniform -->
    <link rel="stylesheet" href="{{asset('css/uniform.default.html')}}"> 
    <!-- Uniform -->
    <link rel="stylesheet" href="{{asset('css/daterangepicker-bs3.css')}}" />
    <!-- Bootstrap toggle -->
    <link rel="stylesheet" href="{{asset('css/bootstrap-switch.css')}}">
    <!-- Bootstrap toggle -->
    <link rel="stylesheet" href="{{asset('js/datatables/css/dataTables.bootstrap.css')}}">
    <!-- Main stylesheet -->
    <link rel="stylesheet" href="{{asset('css/style.css')}}">
    <!-- Widgets stylesheet -->
    <link rel="stylesheet" href="{{asset('css/widgets.css')}}">   
    <!-- Gritter Notifications stylesheet -->
    <link rel="stylesheet" href="{{asset('css/jquery.gritter.css')}}"> 
    <!-- Admin stylesheet -->
    <link rel="stylesheet" href="{{asset('css/admin.css')}}">
{% endblock %}

{% block mainbar %}
    <!-- Main bar -->
    <div class="mainbar">

        <!-- Page heading -->
        <div class="page-head">
            <h2 class="pull-left">Dashboard</h2>
            <div class="pull-right">
                <!--div id="reportrange" class="pull-right">
                    <i class="fa fa-calendar"></i>
                    <span></span> <b class="caret"></b>
                </div-->
            </div>
            <div class="clearfix"></div>
            <!-- Breadcrumb -->
            <div class="bread-crumb">
                <a href="#"><i class="fa fa-home"></i>Dashboard</a> 
            </div>

            <div class="clearfix"></div>

        </div>
        <!-- Page heading ends -->



        <!-- Matter -->

        <div class="matter">
            <div class="container">
                <!-- Todas las publicaciones tipo Publicacion o Noticia -->
                <div class="row">
                    <div class="col-md-12">
                     <ul id="myTab" class="nav nav-tabs">
                      <li class="active"><a href="#publicaciones" data-toggle="tab">Publicaciones</a></li>
                      <li class=""><a href="#llamados" data-toggle="tab">Llamados</a></li>
                      <li class=""><a href="#tuespacio" data-toggle="tab">Tu espacio</a></li>
                      <li class=""><a href="#heraldotv" data-toggle="tab">Heraldo TV</a></li>
                     </ul>
                     <div id="myTabContent" class="tab-content">
                      <div class="tab-pane fade active in" id="publicaciones">
                          {% include 'BackendBundle:Default:controlesPublicaciones.html.twig' with { 'tipoCategoria': categoriaPublicacion } %}
                          {{render(controller('BackendBundle:Default:getPublicaciones', {'tipoCategoria': categoriaPublicacion }))}}
                      </div>
                      <div class="tab-pane fade" id="llamados">
                          {% include 'BackendBundle:Default:controlesPublicaciones.html.twig' with {'tipoCategoria': categoriaLlamados } %}
                          {{render(controller('BackendBundle:Default:getPublicaciones', {'tipoCategoria': categoriaLlamados }))}}
                      </div>
                      <div class="tab-pane fade" id="tuespacio">
                          {% include 'BackendBundle:Default:controlesPublicaciones.html.twig' with {'tipoCategoria': categoriaTuEspacio } %}
                        {{render(controller('BackendBundle:Default:getPublicaciones', {'tipoCategoria': categoriaTuEspacio }))}}
                      </div>
                      <div class="tab-pane fade" id="heraldotv">
                          {% include 'BackendBundle:Default:controlesPublicaciones.html.twig' with {'tipoCategoria': categoriaHeraldoTv } %}
                         {{render(controller('BackendBundle:Default:getPublicaciones', {'tipoCategoria': categoriaHeraldoTv }))}}
                      </div>
                    </div>
                    </div>
                </div>
                

            </div>
        </div>
  </div>
    <!-- Mainbar ends -->        
    <div class="clearfix"></div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script src="{{asset('js/jquery-ui-1.9.2.custom.min.js')}}"></script> <!-- jQuery UI -->
    <script src="{{asset('js/fullcalendar.min.js')}}"></script> <!-- Full Google Calendar - Calendar -->
    <script src="{{asset('js/jquery.rateit.min.js')}}"></script> <!-- RateIt - Star rating -->
    <script src="{{asset('js/jquery.prettyPhoto.js')}}"></script> <!-- prettyPhoto -->

    <!-- jQuery Flot -->
    <script src="{{asset('js/excanvas.min.js')}}"></script>
    <script src="{{asset('js/jquery.flot.js')}}"></script>
    <script src="{{asset('js/jquery.flot.resize.js')}}"></script>
    <script src="{{asset('js/jquery.flot.pie.js')}}"></script>
    <script src="{{asset('js/jquery.flot.stack.js')}}"></script>

    <!-- jQuery Notification - Noty -->
    <script src="{{asset('js/jquery.noty.js')}}"></script> <!-- jQuery Notify -->
    <script src="{{asset('js/themes/default.js')}}"></script> <!-- jQuery Notify -->
    <script src="{{asset('js/layouts/bottom.js')}}"></script> <!-- jQuery Notify -->
    <script src="{{asset('js/layouts/topRight.js')}}"></script> <!-- jQuery Notify -->
    <script src="{{asset('js/layouts/top.js')}}"></script> <!-- jQuery Notify -->
    <!-- jQuery Notification ends -->

    <script src="{{asset('js/datatables/js/jquery.dataTables.js')}}"></script>

    <script src="{{asset('js/sparklines.js')}}"></script> <!-- Sparklines -->
    <script src="{{asset('js/jquery.cleditor.min.js')}}"></script> <!-- CLEditor -->
    <script src="{{asset('js/bootstrap-datetimepicker.min.js')}}"></script> <!-- Date picker -->
    <script src="{{asset('js/jquery.uniform.min.html')}}"></script> <!-- jQuery Uniform -->
    <script src="{{asset('js/jquery.slimscroll.min.js')}}"></script> <!-- jQuery SlimScroll -->
    <script src="{{asset('js/bootstrap-switch.min.js')}}"></script> <!-- Bootstrap Toggle -->
    <script src="{{asset('js/filter.js')}}"></script> <!-- Filter for support page -->
    <script src="{{asset('js/custom.js')}}"></script> <!-- Custom codes -->
    <script src="{{asset('js/sfrichpolis.js')}}"></script>
 <script>
    $(document).ready(function() {
        $('.tipo-categoria-{{categoriaPublicacion}}').dataTable({
            "sPaginationType": "full_numbers",
            "displayLength": 20,
        });
        $('.tipo-categoria-{{categoriaLlamados}}').dataTable({
            "sPaginationType": "full_numbers"
        });
        $('.tipo-categoria-{{categoriaTuEspacio}}').dataTable({
            "sPaginationType": "full_numbers"
        });
        $('.tipo-categoria-{{categoriaHeraldoTv}}').dataTable({
            "sPaginationType": "full_numbers"
        });
        $.configPrettyPhoto();
        $(".loader").fadeOut();
    });

function iniciarlizarFunciones(){
    backend();
    
    controles();
}

function backend(id,clase){
    $(".loader").fadeIn();
    var $registro = $("#registro-"+id);
    var url = $registro.find(clase).data('url');
    $.ajax({
        url: url,
        type: 'PATCH',
        dataType: 'html',
        success: function(data){
            $registro.html($(data).html());
            notySuccess('Actualizacion realizada');
            $.configPrettyPhoto();
            $(".loader").fadeOut();
        },
        error: function(data){
            notyError('Error de actualizacion');
            console.log(data);
            $(".loader").fadeOut();
        },
    });
}

function controles(tipoCategoria, clase){
    $(".loader").fadeIn();
    var tabla =".tipo-categoria-"+ tipoCategoria;
    var claseElemento = clase + "-"+ tipoCategoria
    var $table = $(tabla);
    var url = $(claseElemento).data('url');
    $.ajax({
        url: url,
        type: 'GET',
        dataType: 'html',
        success: function(data){
            $table.html($(data).find(tabla).html());
            $.configPrettyPhoto();
            $(".loader").fadeOut();
        },
        error: function(data){
            notyError('Error al actualizar la informacion');
            console.log(data);
            $(".loader").fadeOut();
        },
    });
}


 </script>


{% endblock %}